Great. I’ll gather all SketchUp Ruby API 2024/2025 methods related to materials, including creation, fetching, manipulation, updating, exporting, and importing. I’ll also include developer guidance such as common pitfalls, best practices, and standard conventions.

The output will begin with a high-level overview, followed by a detailed reference table listing method/class names alongside their descriptions. I’ll update you shortly once the research is complete.


# SketchUp Ruby API Materials Overview (2024/2025)

## Overview of Material Handling in SketchUp Ruby API

SketchUp’s Ruby API provides a **Material** class to represent surface finishes – either solid colours or textured images – that can be applied to drawing elements (most commonly faces). Each SketchUp **Model** contains a **Materials** collection (accessible via `model.materials`) holding all materials in that model. Materials can be created from scratch or loaded from files, edited (colour, texture, transparency, etc.), and assigned to entities like faces, edges, groups, and components.

**Material assignment:** A material can be applied to a face’s front and back sides (faces have separate **front** and **back** materials), or to entire component instances/groups. A material applied to a container (group/component) will display on any faces inside it that have the default material (faces with their own material **override** the container’s material). Best practice is usually to paint **faces** directly rather than whole groups, for more control over texture orientation and consistency. Edges can also have materials (useful when edge render mode is “Color by Material”). If an entity has no material assigned (i.e. `entity.material` is `nil`), it renders with SketchUp’s default material (usually a white/grey colour on front face and a distinct default back face colour).

**Material creation and retrieval:** New materials can be created via the **Materials** collection (e.g. `mat = model.materials.add("Name")`). If no name is given, SketchUp auto-generates a unique name. If a name is provided and a material with that name exists, SketchUp will append a number to make it unique. You can also load existing materials from external files – SketchUp uses **.skm** (SketchUp material) files for materials. The API provides `model.materials.load(path)` to import a material from a .skm file (or even from a SketchUp model `.skp` file containing materials). Once created or loaded, materials reside in the model’s collection and can be retrieved by index or name: e.g. `model.materials[0]` or `model.materials["Brick"]`. The **Materials** collection is enumerable, so you can iterate `model.materials.each` to list all materials. To get the currently selected material in the SketchUp UI’s material picker, use `model.materials.current` (and you can set it via `model.materials.current = some_material`).

**Material properties:** Each **Sketchup::Material** object has properties for its display name, colour, texture, transparency, and more. The **colour** can be accessed or modified via `material.color` (returns a `Sketchup::Color` object) and `material.color=`. The **opacity** (transparency) is controlled via `material.alpha` (a Float between 0.0 fully transparent and 1.0 fully opaque) and set via `material.alpha=`. If a material has a textured image, the **texture** is accessed with `material.texture` (returns a **Sketchup::Texture** object). You can assign a texture image by setting `material.texture = <image>` – this can accept a file path, a `Sketchup::ImageRep` (for raw pixel data), or an array specifying image file and desired size. For example, `material.texture = ["brick.jpg", 10, 10]` loads *brick.jpg* and scales it to 10 inches by 10 inches. Setting `material.texture = nil` removes the texture, reverting the material to a solid colour. Materials with textures can also be **colorized** (tinted): assigning a colour to a textured material doesn’t replace the texture but tints it (SketchUp supports different colorization modes). You can check or set the colorization via `material.colorize_type` (e.g. “shift” or “tint” modes) and retrieve the tint HLS adjustments with `material.colorize_deltas` if needed.

**Advanced (PBR) materials:** Recent SketchUp versions (2020+ and enhanced in 2024/2025) support **PBR (Physically-Based Rendering) materials** with additional maps. In **SketchUp 2024/2025**, a Material can operate in a “metallic-roughness” workflow mode, indicated by `material.workflow`. In this mode, you can assign **metalness**, **roughness**, **normal** (bump), and **ambient occlusion** textures and values to the material. For example, a PBR material might have a base colour/texture plus: a metallic map (`material.metallic_texture`) or uniform metallic factor (`material.metallic_factor`), a roughness map (`material.roughness_texture`) or factor, a normal map (`material.normal_texture`), and an AO map (`material.ao_texture`). These are managed through Material’s PBR-specific methods (detailed in the reference table below). To use these properties, you typically enable the slot (e.g. `material.metalness_enabled = true`) and assign a texture or value. *Note:* Some properties depend on each other – for instance, enabling ambient occlusion requires setting an AO texture first. The **normal map** style can be specified as OpenGL or DirectX via `material.normal_style` (using constants `NORMAL_STYLE_OPENGL` or `NORMAL_STYLE_DIRECTX`) to match the normal map’s coordinate system. Keep in mind that while the SketchUp viewport itself doesn’t fully render effects like metalness or AO, these properties will carry over when exporting to formats that support PBR (such as glTF).

**Saving and exporting materials:** Material changes take effect immediately in the model. To **save** a material externally, use `material.save_as("filename.skm")`, which writes the material (with its texture) to a .skm file. You can also export a material’s texture image: the **Texture** object has a `texture.write(filepath)` method to save the image to disk (with an option to apply colorization). Additionally, `material.write_thumbnail(path, size)` can save a small thumbnail preview image of the material. To remove materials, you can delete individual ones with `model.materials.remove(material)` – but **warning**: if that material is currently applied to any entities, you should first unpaint those entities (set their material to nil) to avoid errors or a “corrupted model” scenario. Alternatively, `model.materials.purge_unused` will safely remove all materials not used by any drawing element.

## Reference: Material-Related Classes and Methods (SketchUp 2024/2025)

Below is a comprehensive table of classes and methods in the SketchUp Ruby API related to creating, fetching, editing, and managing materials. Each entry lists the class and method, along with a description of its purpose in the context of material workflows:

### Sketchup::Material Class (material properties and actions)

| Class::Method                                                                     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| --------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sketchup::Material#name** <br> **Sketchup::Material#name=**                     | Gets or sets the material’s name. The name is a unique identifier within the model’s material collection. Setting a name that conflicts with an existing material will result in a new unique name being generated automatically.                                                                                                                                                                                                                                                                                                                        |
| **Sketchup::Material#display\_name**                                              | Returns the name as shown in SketchUp’s UI. In most cases this matches `#name`, but SketchUp may strip special formatting (e.g. brackets). For example, a material internally named “\[Brick]” would display as “Brick” in the UI. Use `#name` when retrieving materials by name programmatically, as `materials["Name"]` expects the internal name.                                                                                                                                                                                                     |
| **Sketchup::Material#color** <br> **Sketchup::Material#color=**                   | Gets or sets the material’s **base colour** (as a `Sketchup::Color`). You can assign a `Sketchup::Color` object, an array of RGB(A) values, a hex code, or a CSS colour name string. Setting the color on a textured material will **colorize** the texture rather than removing it. (To remove tint on a texture, set the color to nil.) The color retrieved is the material’s current displayed colour (for textured materials, this might be an average or the applied tint).                                                                         |
| **Sketchup::Material#alpha** <br> **Sketchup::Material#alpha=**                   | Gets or sets the material’s **opacity** (transparency). This is a Float between 0.0 (fully transparent) and 1.0 (fully opaque). For example, `material.alpha = 0.5` makes the material 50% transparent. Note that `#alpha` is independent of the colour’s alpha; only this property affects material transparency.                                                                                                                                                                                                                                       |
| **Sketchup::Material#texture**                                                    | Returns a **Sketchup::Texture** object for textured materials, or `nil` if the material has no texture image. Through the Texture object you can query image size, filename, average colour, etc. (see **Texture** methods below).                                                                                                                                                                                                                                                                                                                       |
| **Sketchup::Material#texture=**                                                   | Assigns a **texture image** to the material. Accepts (1) a file path to an image (string), (2) an array `[path, width, height]` or `[path, width]` to specify size in model units, or (3) a `Sketchup::ImageRep` object for raw pixel data. Example: `material.texture = ["tiles.png", 2.m, 2.m]` loads *tiles.png* and scales it to 2×2 meters. Setting `material.texture = nil` removes the texture (material reverts to solid colour). After assigning a texture, you can adjust its scale via the Texture’s `#width`, `#height` or `#size=` methods. |
| **Sketchup::Material#use\_alpha?**                                                | Returns `true` if the material is treated as transparent. This will be true if `material.alpha` is less than 1.0, or if the texture image has transparency (an alpha channel) in use. (*Note:* This is not affected by any alpha value of `material.color` – only the material’s own alpha property or texture’s transparency matter.)                                                                                                                                                                                                                   |
| **Sketchup::Material#colorize\_type** <br> **Sketchup::Material#colorize\_type=** | Gets or sets the **colorization mode** for a textured material. SketchUp supports colorizing a texture by **Tint** or **Shift** (hue shift) modes. `material.colorize_type` returns an integer (0 = none/invalid, 1 = Shift, 2 = Tint) corresponding to constants `COLORIZE_SHIFT` or `COLORIZE_TINT`. You can assign one of those constants to change the mode. This only has effect if the material has a texture and a color (tint) applied.                                                                                                          |
| **Sketchup::Material#colorize\_deltas**                                           | Returns an array of three Float values representing the HLS (Hue, Lightness, Saturation) adjustments used for the material’s colorization. This is relevant for textured materials that have been colorized. (It’s mainly useful if you need to reproduce or analyze the tint effect programmatically.)                                                                                                                                                                                                                                                  |
| **Sketchup::Material#materialType**                                               | Indicates the material’s basic type: 0 for a solid colour, 1 for a textured material, 2 for a textured material that is colorized. You can use constants `MATERIAL_SOLID`, `MATERIAL_TEXTURED`, `MATERIAL_COLORIZED_TEXTURED` (added in SU 2015) to interpret this. This is read-only; the type changes implicitly when you add/remove a texture or colorize.                                                                                                                                                                                            |
| **Sketchup::Material#owner\_type**                                                | Indicates what **owns** the material, returned as an integer constant. In SketchUp, materials can be owned by the model’s material manager or by certain internal owners (like layers or images). For example, `OWNER_LAYER` if the material is the colour used for a tag’s color, `OWNER_IMAGE` for an image’s embedded material, or `OWNER_MANAGER` for regular model materials. In practice, most user-created materials will have `owner_type == Sketchup::Material::OWNER_MANAGER` (meaning it belongs to the model’s main material list).          |
| **Sketchup::Material#save\_as**                                                   | Saves the material to an external **.skm file** (SketchUp material file). For example, `material.save_as("C:/Materials/MyMaterial.skm")` will write the material’s definition (including its texture) to the given file path. Returns true if successful. This allows you to export materials for reuse in other models.                                                                                                                                                                                                                                 |
| **Sketchup::Material#write\_thumbnail**                                           | Writes a **thumbnail image** of the material to the given file path. You can specify the maximum size (in pixels) of the thumbnail. The result is typically a small bitmap showing the material’s colour/texture as it appears in the SketchUp UI. This is useful for preview images or icons. Returns true if successful.                                                                                                                                                                                                                               |

**PBR (Physically-Based Rendering) specific methods** (SketchUp 2024+):

| Class::Method                                                                              | Description                                                                                                                                                                                                                                                                                                                                                                                                                        |
| ------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sketchup::Material#workflow**                                                            | Returns an integer indicating the material’s workflow/style. SketchUp 2024+ supports a **PBR metallic-roughness** workflow. The constant `Sketchup::Material::WORKFLOW_PBR_METALLIC_ROUGHNESS` is used for PBR materials. A legacy non-PBR material may return a different value (e.g., an implicit “classic” workflow). This property is read-only; using any PBR properties will set the material to PBR workflow automatically. |
| **Sketchup::Material#metalness\_enabled?** <br> **Sketchup::Material#metalness\_enabled=** | Gets or sets whether **metalness** is enabled for this material’s PBR definition. When enabled, the material uses a metallic/non-metallic property (either a uniform factor or a texture map). Typically you enable this before assigning a metallic map.                                                                                                                                                                          |
| **Sketchup::Material#metallic\_factor** <br> **Sketchup::Material#metallic\_factor=**      | Gets/sets the **Metallic factor** (as a Float 0.0–1.0) for PBR materials. This represents how metallic the surface is (0 = fully dielectric, 1 = fully metallic) when no metallic texture is used. If a **metallic texture** is assigned, this factor may serve as a global multiplier. Default is 1.0 when metalness is enabled.                                                                                                  |
| **Sketchup::Material#metallic\_texture** <br> **Sketchup::Material#metallic\_texture=**    | Gets or sets the **Metallic texture map** (a grayscale image typically) for PBR. Returns a `Sketchup::Texture` if one is set. To assign, use a file path or `ImageRep` similar to setting any texture. This texture’s pixel values define metallic (white=metal) vs non-metal (black) areas.                                                                                                                                       |
| **Sketchup::Material#roughness\_enabled?** <br> **Sketchup::Material#roughness\_enabled=** | Gets/sets whether **roughness** is enabled for PBR. When enabled, the material will use roughness properties (factor or map). You might disable this if you want to use a legacy shininess (though in PBR, roughness essentially replaces glossiness).                                                                                                                                                                             |
| **Sketchup::Material#roughness\_factor** <br> **Sketchup::Material#roughness\_factor=**    | Gets/sets the **Roughness factor** (Float 0.0–1.0). 0.0 = perfectly smooth/shiny, 1.0 = fully rough (matte). This defines surface microfacet roughness when no roughness texture is present.                                                                                                                                                                                                                                       |
| **Sketchup::Material#roughness\_texture** <br> **Sketchup::Material#roughness\_texture=**  | Gets or sets the **Roughness texture map** for PBR. Like metallic\_texture, this is usually a grayscale image (black = smooth, white = rough). Assignable via file path or ImageRep.                                                                                                                                                                                                                                               |
| **Sketchup::Material#normal\_enabled?** <br> **Sketchup::Material#normal\_enabled=**       | Gets or sets whether a **normal map** is enabled for the material. Enable this before using a normal map texture to ensure it’s recognized.                                                                                                                                                                                                                                                                                        |
| **Sketchup::Material#normal\_texture** <br> **Sketchup::Material#normal\_texture=**        | Gets/sets the **Normal map texture** (a `Sketchup::Texture`) used to give the appearance of bumpiness or relief. This is typically a tangent-space normal map (blue-ish image). Assign via file path or ImageRep.                                                                                                                                                                                                                  |
| **Sketchup::Material#normal\_style** <br> **Sketchup::Material#normal\_style=**            | Gets/sets the **normal map style/orientation**. SketchUp supports OpenGL and DirectX normal conventions. Use constants `NORMAL_STYLE_OPENGL` or `NORMAL_STYLE_DIRECTX` when setting this to ensure the normal map is interpreted correctly. (`NORMAL_STYLE_OPENGL` is likely default.)                                                                                                                                             |
| **Sketchup::Material#normal\_scale** <br> **Sketchup::Material#normal\_scale=**            | Gets/sets a scaling factor for the normal map’s effect (Float, >= 0.0). This can amplify or diminish the bump effect of the normal map. A value of 1.0 uses the map as-is; higher values exaggerate the bumpiness.                                                                                                                                                                                                                 |
| **Sketchup::Material#ao\_enabled?** <br> **Sketchup::Material#ao\_enabled=**               | Gets/sets whether **Ambient Occlusion (AO)** is enabled. AO uses a texture to darken crevices for realism. **Important:** An AO texture must be set **before** enabling (otherwise an error is raised).                                                                                                                                                                                                                            |
| **Sketchup::Material#ao\_texture** <br> **Sketchup::Material#ao\_texture=**                | Gets/sets the **Ambient Occlusion map** (a `Sketchup::Texture`). This is typically a grayscale texture where dark areas represent occluded/shadowed zones. Assign via file path or ImageRep (just like other textures).                                                                                                                                                                                                            |
| **Sketchup::Material#ao\_strength** <br> **Sketchup::Material#ao\_strength=**              | Gets/sets the **Ambient Occlusion strength** (Float 0.0–1.0) which controls how much the AO map darkens the material. 0 means no AO effect, 1 means full use of the AO texture’s values. Typically you’d enable AO, assign a texture, then adjust strength if needed (default might be 1.0).                                                                                                                                       |

### Sketchup::Materials Class (material collection and model-level operations)

| Class::Method                                                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| --------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sketchup::Model#materials**                                         | Returns the **Materials** collection for the model. This is how you access the in-model material library to add or query materials. The collection includes all materials (both user-created and any default materials in the model).                                                                                                                                                                                                                                                                          |
| **Sketchup::Materials#\[]** (index or name)                           | Retrieves a material by index or name. For example, `materials[0]` returns the first material, and `materials["Wood"]` looks up by name. If the index is out of range or name not found, returns `nil`. (`Materials#at` is an alias for `#[]`.)                                                                                                                                                                                                                                                                |
| **Sketchup::Materials#add**                                           | Creates a new material and adds it to the collection. Usage: `materials.add("Name")`. If no name is given, a unique name like “Material#” is generated. If the given name already exists, SketchUp will modify it (e.g. append a number) to ensure uniqueness. Returns the new `Sketchup::Material` object.                                                                                                                                                                                                    |
| **Sketchup::Materials#load**                                          | Loads a material from a file into the model’s collection. Accepts a file path to a **.skm** material file (or a .skp file containing materials). Returns a `Sketchup::Material` – if the material file matches an existing in-model material, it may return the existing one, otherwise a new material is added. This is useful for importing predefined materials (including those from SketchUp’s library) programmatically.                                                                                 |
| **Sketchup::Materials#length** <br> **Sketchup::Materials#size**      | Returns the number of materials in the collection. `#size` and `#length` are equivalent. You can also call `materials.count`.                                                                                                                                                                                                                                                                                                                                                                                  |
| **Sketchup::Materials#each**                                          | Iterates through all materials (includes Enumerable mix-in). You can use this in a block to go through every material in the model. (*Note:* Avoid adding/removing materials within an `each` loop; if you need to purge or remove items while iterating, first copy to an array to avoid skipping elements.)                                                                                                                                                                                                  |
| **Sketchup::Materials#current** <br> **Sketchup::Materials#current=** | Gets or sets the **current material** in the SketchUp UI’s material editor. For example, `mat = model.materials.current` gives the material currently selected in the Paint Bucket tool, and `model.materials.current = mat` will select/highlight a material in the UI. This is useful if your plugin wants to interface with the Paint tool or reflect user’s selection.                                                                                                                                     |
| **Sketchup::Materials#remove**                                        | Removes a given material from the model’s collection. Returns true if removed, false on failure. **Important:** If the material is in use (painted on any entity), it cannot be fully removed without first clearing it from those entities. The recommended approach is to set that material to nil on all faces/groups using it before calling remove. (Alternatively, use `purge_unused` to automatically skip in-use materials.) Improper use of `remove` on a used material can lead to an invalid state. |
| **Sketchup::Materials#purge\_unused**                                 | Removes **all materials that are not currently applied** to any geometry. This is a convenient way to clean up the material list. It returns the Materials collection itself. After this call, the model.materials will only contain materials that were in use. Use with caution if the user expects unused materials to remain.                                                                                                                                                                              |
| **Sketchup::Materials#unique\_name**                                  | Generates a unique material name based on a given base string. For example, `materials.unique_name("Brick")` might return `"Brick#1"` if “Brick” is already taken. This is useful when programmatically creating many materials to avoid name collisions. (Note that `add` calls this internally when needed.)                                                                                                                                                                                                 |

### Applying Materials to Entities (Faces, Groups, Components, Edges)

| Class::Method                                                                     | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| --------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sketchup::Face#material** <br> **Sketchup::Face#material=**                     | Gets or sets the material on a face’s **front side**. For example, `face.material = some_material` applies a material to the face’s front. If a face has a front material and no explicit back material, the back will render either the default or the front material depending on the viewing style (in SketchUp, back-faces don’t automatically inherit the front material, so it’s common to set both if needed). You can assign a `Sketchup::Material` object here, or as a shortcut you may assign a colour or name (the API will create or use a matching material).                                                                                                                                       |
| **Sketchup::Face#back\_material** <br> **Sketchup::Face#back\_material=**         | Gets or sets the material on a face’s **back side**. Works similarly to `face.material`. For two-sided faces (e.g. windows or thin walls), you might want a different back material. If you set a back material, that face will have distinct front/back appearances; if you want the back to look the same as front, you can either apply the same material to both sides or leave back\_material nil and enable “use front material on back” rendering option.                                                                                                                                                                                                                                                  |
| **Sketchup::Drawingelement#material** <br> **Sketchup::Drawingelement#material=** | Most geometry entities (edges, groups, component instances, images) inherit this method from the Drawingelement class. It gets or sets the **material of the entity**. For a Group or ComponentInstance, this material is applied to the **container as a whole** – faces inside that have no material will display this material (faces with their own material are unaffected). For an Edge, setting a material gives the edge that color (visible when edge rendering is set to “All Same” off). You can assign a Material, or a color/name convertible to a material, just like with face.material. To **clear** a material from an entity (revert it to default), assign `nil` (e.g. `edge.material = nil`). |

### Sketchup::Texture Class (texture information and image handling)

When a material has an associated texture image, the **Sketchup::Texture** object provides details and image manipulation methods:

| Class::Method                                                               | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| --------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Sketchup::Texture#width** <br> **Sketchup::Texture#height**               | Returns the width or height of the texture **in model units** (typically inches by default). This is the real-world size that the image represents on surfaces. For example, a brick texture might be 10 inches wide. You can set a new size via `Texture#size=(new_width)` to uniformly scale, or pass an array `[new_width, new_height]` to set dimensions explicitly.                                                                                          |
| **Sketchup::Texture#image\_width** <br> **Sketchup::Texture#image\_height** | Returns the pixel dimensions of the texture image file (width and height in pixels). This is useful to know the resolution of the image.                                                                                                                                                                                                                                                                                                                          |
| **Sketchup::Texture#filename**                                              | Returns the file path of the texture image, if available. For textures loaded from an external image, this will be that image’s path. If the material was loaded from a SKM, the texture might be embedded (the method may still give a path to a cached file).                                                                                                                                                                                                   |
| **Sketchup::Texture#average\_color**                                        | Returns a `Sketchup::Color` representing the **average colour** of the texture image. This is calculated by sampling the image. It’s useful for quick approximations of a texture’s overall colour tone (e.g. for display in list or for color-by-layer style).                                                                                                                                                                                                   |
| **Sketchup::Texture#image\_rep**                                            | Returns a `Sketchup::ImageRep` object containing the raw pixel data of the texture. You can use this to manipulate or examine the image at the pixel level (for instance, to generate procedural textures or export in a different format). Changing pixels would involve modifying the ImageRep and then reassigning via `material.texture= image_rep`. (*Advanced use* – not needed for typical plugins).                                                       |
| **Sketchup::Texture#write**                                                 | Saves the texture image to a file. Usage: `texture.write(file_path, colorize: false)` (the second parameter may be a boolean or sometimes just an argument in older API). If the material is colorized (tinted), you can choose to write the original image (`colorize=false`) or the colorized version (`colorize=true`). This is a convenient way to extract the actual image used in a material (e.g., to edit in an external editor or use in documentation). |

## Developer Tips and Best Practices for Working with Materials

* **Creating vs. reusing materials:** When adding materials, decide if you need a brand new material or can reuse an existing one. SketchUp prevents exact name duplicates by auto-renaming, but you may end up with “Material1”, “Material2”, etc. if you blindly add in a loop. To avoid clutter, you can search the collection by name or properties (e.g. find a material with the same color/texture) before adding new. The `Materials#unique_name` method can help generate new names systematically. Always give materials meaningful names if they will persist in the model.

* **Assigning materials by color:** The API allows you to assign a raw color or name to `entity.material` or `materials.add`. For example, `face.material = "Red"` or `face.material = [255,0,0]` will create or use a material of that colour. This is handy for quick assignments, but note that it will create an actual Material object in the model’s collection if one with an identical color doesn’t already exist. If you assign the same color string multiple times, you might get multiple materials (e.g., "Red", "Red#1", etc.), so for consistency consider creating the material once and reusing it.

* **Front vs. back face materials:** Remember that a face can have two different materials. By convention, front faces should carry the visible material. It’s good practice in modeling to keep faces oriented correctly (white front side out) and apply materials to fronts. Only use back\_face materials when necessary (e.g., transparent objects where back faces might show, or two-sided different finishes). If you want an object to look the same on both sides, you can either paint both sides or rely on styles that use front material for back (though the latter is a viewport setting, not a model property).

* **Group and Component painting:** Applying a material to an entire group or component instance will color all default-painted faces inside it. This is a quick way to change colours of an object without editing it. However, any face that has its own material will not be affected by the container’s material. A common workflow is to leave all faces inside components unpainted (default) and only paint the component from outside – then all instances can be recolored easily by changing the one material. Conversely, if you need per-face textures (for alignment or detail), paint the faces individually. **Avoid double-painting:** If a face is painted and its group is painted a different color, the face’s paint wins, which can confuse users. It’s usually best to choose one method and stick with it for a given object (with the recommendation to paint faces for complex textures).

* **Transparency and rendering:** Materials with `alpha < 1.0` or PNG textures with transparency will render as transparent in SketchUp. Keep in mind that SketchUp does not support layered transparency well (there can be draw-order issues). For performance, try not to use excessively large transparent textures. If you want an object to be fully invisible, it’s better to hide it or use layer/tag visibility rather than 100% transparent material, to avoid it still affecting rendering order.

* **Refreshing the view:** Normally, assigning materials via the API updates the model immediately. If you script a lot of changes (e.g., painting many faces), you might not see the update until the operation completes. Wrapping changes in `model.start_operation ... model.commit_operation` is recommended for efficiency, and you can call `model.active_view.invalidate` to refresh the view if needed. In some cases (particularly with Dynamic Components or if you change component definitions’ materials), you might need to force a redraw or regenerate those components. If you find that a material change doesn’t show up until after saving or a manual refresh, ensure you are not in a suspended undo operation and consider triggering a view refresh.

* **Removing and purging materials:** Use `materials.remove(mat)` carefully. As noted, if the material is applied to any entity, remove will fail (return false) or worse, possibly remove it from the library while it remains referenced on faces (which can lead to a “ghost” material). Always **unpaint entities** using a material before removing it. An example procedure is: iterate over all faces (and other draw elements), set any usage of that material to nil, then call `materials.remove(mat)`. Alternatively, use `materials.purge_unused` to clear all unused materials at once – SketchUp will only remove those not in use. Purge is easier but less selective (it might remove things the user expected to keep if they were just temporarily unused). If your extension deletes geometry, consider purging afterward to clean up now-unused materials.

* **Observers for materials:** If your plugin needs to react to user material changes (like a user editing a material’s colour or adding a new material), consider using a **MaterialsObserver** or **MaterialObserver**. The API lets you attach observers to watch for events like `onMaterialAdd`, `onMaterialChange`, etc. This can be helpful for keeping your UI in sync with the model’s materials. (This is an advanced use; set up an observer on `model.materials.add_observer` with a custom Ruby class implementing the callback methods.)

* **Performance considerations:** Working with materials (especially applying textures) can be performance-heavy if done in large quantities. To improve performance:

  * Try to reuse materials instead of duplicating them.
  * If applying the same material to many faces, retrieve the material object once and reuse the reference rather than looking it up by name each time.
  * Large textures can slow down SketchUp; you might downsize images if ultra-high resolution isn’t needed. There are also SketchUp limitations on maximum texture dimensions (typically 1024 or 2048 pixels in older versions for display, higher in newer).
  * When iterating over thousands of faces to assign materials, wrap in a single operation (for undo batching) and consider temporarily turning off view updates (e.g., use `model.start_operation(..., disable_ui: true)`).

* **Using PBR properties:** Physically-Based Rendering attributes in SketchUp (metalness, roughness, etc.) are primarily for interoperability with rendering engines or export formats. SketchUp’s viewport doesn’t fully simulate metallic reflections or roughness, so don’t be alarmed if changing `metallic_factor` or `roughness_factor` doesn’t visibly change the model in SketchUp – it will matter in renders. Ensure that when you enable a PBR property that requires a texture (like AO) you set the texture first. Also, **normal maps** can significantly impact appearance in renders – use the correct `normal_style` constant to match your texture (most normal maps from 3D painting tools are DirectX style, which in SketchUp might need `NORMAL_STYLE_DIRECTX` if the default is OpenGL). If a normal map looks inverted, try switching the style. Lastly, when exporting, be aware that not all exporters use these new properties yet (but formats like glTF and USD do).

By following these guidelines and using the above API methods, you can effectively create and manage materials in SketchUp 2024/2025, giving your plugin full control over colors, textures, and advanced material properties. Always refer to the official SketchUp Ruby API documentation for the latest details and any version-specific notes, and test material operations on sample models to ensure the behavior matches your expectations. With careful use of the API, you can automate complex material workflows and integrate SketchUp’s material system seamlessly into your extension’s functionality.


# Hello!
## This 

### Is 

#### An Example 
---

Table | Example | Example
--- | --- | ---
1 | 2 | 3
3 | 4 | 5
6 | 7 | 8

---
## Next Section 
Blah Blah Blah

---
## Next Section 
Blah Blah Blah

---
## Next Section 
Blah Blah Blah

---
## Next Section 
Blah Blah 

[Noble Architecture ](https://www.noble-architecture.com/)

[Noble Architecture](https://www.noble-architecture.com/)

[Noble Architecture](https://www.noble-architecture.com/)

[Noble Architecture](https://www.noble-architecture.com/)

[Noble Architecture](https://www.noble-architecture.com/)